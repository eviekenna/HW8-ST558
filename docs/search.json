[
  {
    "objectID": "Hw8-Basic_Modeling_Practice.html",
    "href": "Hw8-Basic_Modeling_Practice.html",
    "title": "HW8-Basic Modeling Practice",
    "section": "",
    "text": "##Reading the Data\nlibrary(readr)\nbike_data &lt;- read_csv(\"SeoulBikeData.csv\", locale = locale(encoding = \"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n##EDA First we need to investigate the data and understand how it is stored.\nChecking for missing values in the dataset.\ncolSums(is.na(bike_data))\n\n                     Date         Rented Bike Count                      Hour \n                        0                         0                         0 \n          Temperature(°C)               Humidity(%)          Wind speed (m/s) \n                        0                         0                         0 \n         Visibility (10m) Dew point temperature(°C)   Solar Radiation (MJ/m2) \n                        0                         0                         0 \n             Rainfall(mm)             Snowfall (cm)                   Seasons \n                        0                         0                         0 \n                  Holiday           Functioning Day \n                        0                         0\nWe can see from the output that there are no missing values in this data set.\nNext we look at the column types and the values within the columns to make sure that they are consistent with what we would expect. Using str to show us how it is stored.\nstr(bike_data)\n\nspc_tbl_ [8,760 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Date                     : chr [1:8760] \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" ...\n $ Rented Bike Count        : num [1:8760] 254 204 173 107 78 100 181 460 930 490 ...\n $ Hour                     : num [1:8760] 0 1 2 3 4 5 6 7 8 9 ...\n $ Temperature(°C)          : num [1:8760] -5.2 -5.5 -6 -6.2 -6 -6.4 -6.6 -7.4 -7.6 -6.5 ...\n $ Humidity(%)              : num [1:8760] 37 38 39 40 36 37 35 38 37 27 ...\n $ Wind speed (m/s)         : num [1:8760] 2.2 0.8 1 0.9 2.3 1.5 1.3 0.9 1.1 0.5 ...\n $ Visibility (10m)         : num [1:8760] 2000 2000 2000 2000 2000 ...\n $ Dew point temperature(°C): num [1:8760] -17.6 -17.6 -17.7 -17.6 -18.6 -18.7 -19.5 -19.3 -19.8 -22.4 ...\n $ Solar Radiation (MJ/m2)  : num [1:8760] 0 0 0 0 0 0 0 0 0.01 0.23 ...\n $ Rainfall(mm)             : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Snowfall (cm)            : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Seasons                  : chr [1:8760] \"Winter\" \"Winter\" \"Winter\" \"Winter\" ...\n $ Holiday                  : chr [1:8760] \"No Holiday\" \"No Holiday\" \"No Holiday\" \"No Holiday\" ...\n $ Functioning Day          : chr [1:8760] \"Yes\" \"Yes\" \"Yes\" \"Yes\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Date = col_character(),\n  ..   `Rented Bike Count` = col_double(),\n  ..   Hour = col_double(),\n  ..   `Temperature(°C)` = col_double(),\n  ..   `Humidity(%)` = col_double(),\n  ..   `Wind speed (m/s)` = col_double(),\n  ..   `Visibility (10m)` = col_double(),\n  ..   `Dew point temperature(°C)` = col_double(),\n  ..   `Solar Radiation (MJ/m2)` = col_double(),\n  ..   `Rainfall(mm)` = col_double(),\n  ..   `Snowfall (cm)` = col_double(),\n  ..   Seasons = col_character(),\n  ..   Holiday = col_character(),\n  ..   `Functioning Day` = col_character()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt;\nCheck the unique levels of Seasons and Holiday\nunique(bike_data$Seasons)\n\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\nunique(bike_data$Holiday)\n\n[1] \"No Holiday\" \"Holiday\"\nChange the way Seasons, Holiday and Functioning day are stored to be a factors with ordered levels and convert the date column to dmy using the lubridate package date column.\nlibrary(lubridate)\n\n\nAttaching package: 'lubridate'\n\n\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats 1.0.0     ✔ stringr 1.5.1\n✔ ggplot2 4.0.0     ✔ tibble  3.2.1\n✔ purrr   1.1.0     ✔ tidyr   1.3.1\n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nbike_data|&gt;\n  mutate(Holiday=as.factor(Holiday),\n         Seasons=factor(Seasons, levels=c(\"Winter\",\"Spring\",\"Summer\",\"Autumn\")),\n         Date=dmy(Date),\n         `Functioning Day`= as.factor(`Functioning Day`))\n\n# A tibble: 8,760 × 14\n   Date       `Rented Bike Count`  Hour `Temperature(°C)` `Humidity(%)`\n   &lt;date&gt;                   &lt;dbl&gt; &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;\n 1 2017-12-01                 254     0              -5.2            37\n 2 2017-12-01                 204     1              -5.5            38\n 3 2017-12-01                 173     2              -6              39\n 4 2017-12-01                 107     3              -6.2            40\n 5 2017-12-01                  78     4              -6              36\n 6 2017-12-01                 100     5              -6.4            37\n 7 2017-12-01                 181     6              -6.6            35\n 8 2017-12-01                 460     7              -7.4            38\n 9 2017-12-01                 930     8              -7.6            37\n10 2017-12-01                 490     9              -6.5            27\n# ℹ 8,750 more rows\n# ℹ 9 more variables: `Wind speed (m/s)` &lt;dbl&gt;, `Visibility (10m)` &lt;dbl&gt;,\n#   `Dew point temperature(°C)` &lt;dbl&gt;, `Solar Radiation (MJ/m2)` &lt;dbl&gt;,\n#   `Rainfall(mm)` &lt;dbl&gt;, `Snowfall (cm)` &lt;dbl&gt;, Seasons &lt;fct&gt;, Holiday &lt;fct&gt;,\n#   `Functioning Day` &lt;fct&gt;\nLook at some quick numerical summaries of the data using the psych describe package.\npsych::describe(bike_data)\n\n                          vars    n    mean     sd  median trimmed    mad   min\nDate*                        1 8760  183.00 105.37  183.00  183.00 134.92   1.0\nRented Bike Count            2 8760  704.60 645.00  504.50  612.58 553.75   0.0\nHour                         3 8760   11.50   6.92   11.50   11.50   8.90   0.0\nTemperature(°C)              4 8760   12.88  11.94   13.70   13.19  13.94 -17.8\nHumidity(%)                  5 8760   58.23  20.36   57.00   58.02  23.72   0.0\nWind speed (m/s)             6 8760    1.72   1.04    1.50    1.63   1.04   0.0\nVisibility (10m)             7 8760 1436.83 608.30 1698.00 1509.50 447.75  27.0\nDew point temperature(°C)    8 8760    4.07  13.06    5.10    4.76  14.38 -30.6\nSolar Radiation (MJ/m2)      9 8760    0.57   0.87    0.01    0.38   0.01   0.0\nRainfall(mm)                10 8760    0.15   1.13    0.00    0.00   0.00   0.0\nSnowfall (cm)               11 8760    0.08   0.44    0.00    0.00   0.00   0.0\nSeasons*                    12 8760    2.50   1.11    2.00    2.49   1.48   1.0\nHoliday*                    13 8760    1.95   0.22    2.00    2.00   0.00   1.0\nFunctioning Day*            14 8760    1.97   0.18    2.00    2.00   0.00   1.0\n                              max   range  skew kurtosis   se\nDate*                      365.00  364.00  0.00    -1.20 1.13\nRented Bike Count         3556.00 3556.00  1.15     0.85 6.89\nHour                        23.00   23.00  0.00    -1.20 0.07\nTemperature(°C)             39.40   57.20 -0.20    -0.84 0.13\nHumidity(%)                 98.00   98.00  0.06    -0.80 0.22\nWind speed (m/s)             7.40    7.40  0.89     0.73 0.01\nVisibility (10m)          2000.00 1973.00 -0.70    -0.96 6.50\nDew point temperature(°C)   27.20   57.80 -0.37    -0.76 0.14\nSolar Radiation (MJ/m2)      3.52    3.52  1.50     1.12 0.01\nRainfall(mm)                35.00   35.00 14.53   284.76 0.01\nSnowfall (cm)                8.80    8.80  8.44    93.73 0.00\nSeasons*                     4.00    3.00  0.00    -1.35 0.01\nHoliday*                     2.00    1.00 -4.16    15.33 0.00\nFunctioning Day*             2.00    1.00 -5.17    24.72 0.00\nRename all of the variables to have easier names.\nbike_data&lt;- bike_data|&gt;\n  rename(Temperature=`Temperature(°C)`, Visibility=`Visibility (10m)`,DewPointTemperature=`Dew point temperature(°C)`,SolarRadiation=`Solar Radiation (MJ/m2)`,Humidity=`Humidity(%)`,WindSpeed=`Wind speed (m/s)`,Rainfall=`Rainfall(mm)`, RentedBikeCount=`Rented Bike Count`, Snowfall=`Snowfall (cm)`,FunctioningDay=`Functioning Day`)\nLooking at some summary statistics of the numerical data.\nlibrary(dplyr)\nbike_data |&gt;\n  summarize(across(where(is.numeric),\n                   list(mean = mean, median = median, sd = sd, min = min, max = max),\n                   .names = \"{.fn}_{.col}\"))\n\n# A tibble: 1 × 50\n  mean_RentedBikeCount median_RentedBikeCount sd_RentedBikeCount\n                 &lt;dbl&gt;                  &lt;dbl&gt;              &lt;dbl&gt;\n1                 705.                   504.               645.\n# ℹ 47 more variables: min_RentedBikeCount &lt;dbl&gt;, max_RentedBikeCount &lt;dbl&gt;,\n#   mean_Hour &lt;dbl&gt;, median_Hour &lt;dbl&gt;, sd_Hour &lt;dbl&gt;, min_Hour &lt;dbl&gt;,\n#   max_Hour &lt;dbl&gt;, mean_Temperature &lt;dbl&gt;, median_Temperature &lt;dbl&gt;,\n#   sd_Temperature &lt;dbl&gt;, min_Temperature &lt;dbl&gt;, max_Temperature &lt;dbl&gt;,\n#   mean_Humidity &lt;dbl&gt;, median_Humidity &lt;dbl&gt;, sd_Humidity &lt;dbl&gt;,\n#   min_Humidity &lt;dbl&gt;, max_Humidity &lt;dbl&gt;, mean_WindSpeed &lt;dbl&gt;,\n#   median_WindSpeed &lt;dbl&gt;, sd_WindSpeed &lt;dbl&gt;, min_WindSpeed &lt;dbl&gt;, …\nNow focusing on RentedBikeCount accross the catagorical variables.\nlibrary(dplyr)\nbike_data |&gt;\n  group_by(Seasons) |&gt;\n  summarize(mean_rent = mean(RentedBikeCount),\n            median_rent = median(RentedBikeCount),\n            sd_rent = sd(RentedBikeCount),\n            n = n())\n\n# A tibble: 4 × 5\n  Seasons mean_rent median_rent sd_rent     n\n  &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;\n1 Autumn       820.        764.    651.  2184\n2 Spring       730.        583     622.  2208\n3 Summer      1034.        906.    690.  2208\n4 Winter       226.        203     150.  2160\n\nbike_data |&gt;\n  group_by(Holiday) |&gt;\n  summarize(mean_rent = mean(RentedBikeCount),\n            median_rent = median(RentedBikeCount),\n            sd_rent = sd(RentedBikeCount))\n\n# A tibble: 2 × 4\n  Holiday    mean_rent median_rent sd_rent\n  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;\n1 Holiday         500.        240     571.\n2 No Holiday      715.        524.    647.\n\nbike_data |&gt;\n  group_by(FunctioningDay) |&gt;\n  summarize(mean_rent = mean(RentedBikeCount),\n            median_rent = median(RentedBikeCount))\n\n# A tibble: 2 × 3\n  FunctioningDay mean_rent median_rent\n  &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;\n1 No                    0            0\n2 Yes                 729.         542\nAfter looking at the summaries accross the data here the FunctioningDay data is always yes and never no so it provides no useful information for analysis so the decision here is to drop that column.\nbike_data &lt;- bike_data |&gt; select(-FunctioningDay)\nSummarizing across the hours so that each day has one observation associated with it.\nlibrary(dplyr)\n\nbike_daily &lt;- bike_data |&gt;\n  group_by(Date, Seasons, Holiday) |&gt;\n  summarize(\n    # totals per day\n    TotalBikes = sum(RentedBikeCount, na.rm = TRUE),\n    TotalRainfall = sum(Rainfall, na.rm = TRUE),\n    TotalSnowfall = sum(Snowfall, na.rm = TRUE),\n\n    # daily mean weather conditions\n    MeanTemp = mean(Temperature, na.rm = TRUE),\n    MeanHumidity = mean(Humidity, na.rm = TRUE),\n    MeanWindSpeed = mean(WindSpeed, na.rm = TRUE),\n    MeanVisibility = mean(Visibility, na.rm = TRUE),\n    MeanDewPoint = mean(DewPointTemperature, na.rm = TRUE),\n    MeanSolarRadiation = mean(SolarRadiation, na.rm = TRUE),\n    .groups = \"drop\"\n  )\nCreating a summary of the variables in the new data frame.\nlibrary(dplyr)\n\n# Overall summaries for variables\ndaily_summary &lt;- bike_daily |&gt;\n  summarize(\n    n_days        = n(),\n    bikes_mean    = mean(TotalBikes),  bikes_sd = sd(TotalBikes),\n    bikes_median  = median(TotalBikes), bikes_IQR = IQR(TotalBikes),\n    rain_sum      = sum(TotalRainfall), snow_sum = sum(TotalSnowfall),\n    temp_mean     = mean(MeanTemp),     temp_sd  = sd(MeanTemp),\n    hum_mean      = mean(MeanHumidity), wind_mean = mean(MeanWindSpeed),\n    vis_mean      = mean(MeanVisibility), dew_mean = mean(MeanDewPoint),\n    solar_mean    = mean(MeanSolarRadiation)\n  )\ndaily_summary\n\n# A tibble: 1 × 14\n  n_days bikes_mean bikes_sd bikes_median bikes_IQR rain_sum snow_sum temp_mean\n   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1    365     16910.   10259.        17730     19575    1303.     658.      12.9\n# ℹ 6 more variables: temp_sd &lt;dbl&gt;, hum_mean &lt;dbl&gt;, wind_mean &lt;dbl&gt;,\n#   vis_mean &lt;dbl&gt;, dew_mean &lt;dbl&gt;, solar_mean &lt;dbl&gt;\nLooking at summaries based on Season and Holiday.\n# Summaries by Season and Holiday\nby_season &lt;- bike_daily |&gt;\n  group_by(Seasons) |&gt;\n  summarise(\n    days = n(),\n    bikes_mean = mean(TotalBikes), bikes_median = median(TotalBikes),\n    temp_mean  = mean(MeanTemp),   rain_sum = sum(TotalRainfall),\n    .groups = \"drop\"\n  )\n\nby_holiday &lt;- bike_daily |&gt;\n  group_by(Holiday) |&gt;\n  summarise(\n    days = n(),\n    bikes_mean = mean(TotalBikes), bikes_median = median(TotalBikes),\n    rain_sum   = sum(TotalRainfall), snow_sum = sum(TotalSnowfall),\n    .groups = \"drop\"\n  )\n\nby_season\n\n# A tibble: 4 × 6\n  Seasons  days bikes_mean bikes_median temp_mean rain_sum\n  &lt;chr&gt;   &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n1 Autumn     91     19670.       21545      14.1     268. \n2 Spring     92     17521.       17419      13.0     404. \n3 Summer     92     24818.       25572.     26.6     560. \n4 Winter     90      5413.        5498      -2.54     70.9\n\nby_holiday\n\n# A tibble: 2 × 6\n  Holiday     days bikes_mean bikes_median rain_sum snow_sum\n  &lt;chr&gt;      &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n1 Holiday       18     11994.         6158     33.7      22 \n2 No Holiday   347     17165.        18363   1269.      636.\nA few plots to visualize the data better.\nlibrary(ggplot2)\n#Temperature vs Rentals\nggplot(bike_daily, aes(x = MeanTemp, y = TotalBikes, color = Seasons)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(se = FALSE) +\n  labs(title = \"Temperature vs Total Bikes Rented\", x = \"Mean Daily Temp (°C)\", y = \"Total Bikes Rented\")\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n# Boxplots of rentals by Season and Holiday\n#Season\nggplot(bike_daily, aes(x = Seasons, y = TotalBikes, fill = Seasons)) +\n  geom_boxplot(outlier.alpha = 0.3) +\n  labs(title = \"Distribution of Daily Rentals by Season\", x = \"Season\", y = \"Total Bikes Rented\") +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n#Holiday\nggplot(bike_daily, aes(x = Holiday, y = TotalBikes, fill = Holiday)) +\n  geom_boxplot(outlier.alpha = 0.3) +\n  labs(title = \"Daily Rentals: Holiday vs Non-Holiday\", x = \"Holiday\", y = \"Total Bikes\") +\n  theme(legend.position = \"none\")\nSeeing if there are any correlations between the numeric variables\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n\nbike_daily |&gt;\n  select(where(is.numeric)) |&gt;\n  pivot_longer(everything(), names_to = \"Variable\", values_to = \"Value\") |&gt;\n  ggplot(aes(x = Value, fill = Variable)) +\n  geom_histogram(show.legend = FALSE, bins = 30, alpha = 0.7) +\n  facet_wrap(~ Variable, scales = \"free\", ncol = 3) +\n  labs(title = \"Distribution of Numeric Variables\",\n       x = \"Value\", y = \"Frequency\") +\n  theme_minimal()\nnum_vars &lt;- c(\"MeanTemp\", \"MeanHumidity\", \"MeanWindSpeed\",\n              \"TotalRainfall\", \"TotalSnowfall\", \"MeanVisibility\")\n\nfor (v in num_vars) {\n  p &lt;- ggplot(bike_daily, aes_string(x = v, y = \"TotalBikes\")) +\n    geom_point(alpha = 0.5, color = \"darkblue\") +\n    geom_smooth(method = \"lm\", se = FALSE, color = \"red\", linewidth = 0.8) +\n    labs(title = paste(\"Total Bikes vs\", v),\n         x = v, y = \"Total Daily Rentals\") +\n    theme_minimal()\n  print(p)\n}\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "Hw8-Basic_Modeling_Practice.html#slitting-the-data",
    "href": "Hw8-Basic_Modeling_Practice.html#slitting-the-data",
    "title": "HW8-Basic Modeling Practice",
    "section": "Slitting the Data",
    "text": "Slitting the Data\nSplitting the data using tidymodels split and stratifying based on seasons. Using a 25/75 split.\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.4.1 ──\n\n\n✔ broom        1.0.10     ✔ rsample      1.3.1 \n✔ dials        1.4.2      ✔ tailor       0.1.0 \n✔ infer        1.0.9      ✔ tune         2.0.1 \n✔ modeldata    1.5.1      ✔ workflows    1.3.0 \n✔ parsnip      1.3.3      ✔ workflowsets 1.1.1 \n✔ recipes      1.3.1      ✔ yardstick    1.3.2 \n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nset.seed(123)  # for reproducibility\nbike_daily&lt;- bike_daily|&gt;\n  mutate(Date= as.Date(Date, format=\"%d/%m/%Y\"))\n\n# 75/25 split, stratified by Seasons\nbike_split &lt;- initial_split(bike_daily, prop = 0.75, strata = Seasons)\n\n# Create training and testing sets\nbike_train &lt;- training(bike_split)\nbike_test  &lt;- testing(bike_split)\n\n# check sizes\nnrow(bike_train)\n\n[1] 273\n\nnrow(bike_test)\n\n[1] 92\n\n\n\nbike_train &lt;- bike_train |&gt;\n  mutate(Date = as.Date(Date, format = \"%d/%m/%Y\"))\n\nbike_test &lt;- bike_test |&gt;\n  mutate(Date = as.Date(Date, format = \"%d/%m/%Y\"))\n\nCreating a 10-fold CV split on the training set\n\nlibrary(tidymodels)\n\n# 10-fold cross-validation, stratified by Seasons\nset.seed(123)\nbike_folds &lt;- vfold_cv(bike_train, v = 10, strata = Seasons)\n\n# View structure\nbike_folds\n\n#  10-fold cross-validation using stratification \n# A tibble: 10 × 2\n   splits           id    \n   &lt;list&gt;           &lt;chr&gt; \n 1 &lt;split [245/28]&gt; Fold01\n 2 &lt;split [245/28]&gt; Fold02\n 3 &lt;split [245/28]&gt; Fold03\n 4 &lt;split [245/28]&gt; Fold04\n 5 &lt;split [245/28]&gt; Fold05\n 6 &lt;split [245/28]&gt; Fold06\n 7 &lt;split [245/28]&gt; Fold07\n 8 &lt;split [246/27]&gt; Fold08\n 9 &lt;split [247/26]&gt; Fold09\n10 &lt;split [249/24]&gt; Fold10\n\n\n#Fitting MLR Models\n\nlibrary(tidymodels)\nlibrary(dplyr)\n#1st Recipie\nrec_mlr_1 &lt;- recipe(TotalBikes ~ ., data = bike_train) |&gt;\n  # 1) Derive day-of-week from Date, then build weekday/weekend factor\n  step_date(Date, features = \"dow\", label = TRUE) |&gt;        # creates Date_dow as ordered factor (Mon,...,Sun)\n  step_mutate(day_type = factor(if_else(Date_dow %in% c(\"Sat\",\"Sun\"),\n                                        \"Weekend\", \"Weekday\"))) |&gt;\n  step_rm(Date_dow) |&gt;                                       # drop intermediate\n  update_role(Date, new_role = \"ID\") |&gt;                      # keep Date only as an ID (ignored by model)\n\n  # 2) Standardize numeric predictors (scales differ)\n  step_normalize(all_numeric_predictors()) |&gt;\n\n  # 3) Dummy-code categorical predictors (Seasons, Holiday, day_type)\n  step_dummy(all_nominal_predictors(), one_hot = TRUE)\n\n\nlibrary(tidymodels)\nlibrary(dplyr)\n\n# Recipe 2\nrec_mlr_2 &lt;- recipe(TotalBikes ~ ., data = bike_train) |&gt;\n  # 1) Use Date to create weekday/weekend, then keep Date as an ID\n  step_date(Date, features = \"dow\", label = TRUE) |&gt;               # creates Date_dow\n  step_mutate(day_type = factor(if_else(Date_dow %in% c(\"Sat\",\"Sun\"),\n                                        \"Weekend\", \"Weekday\"))) |&gt;\n  step_rm(Date_dow) |&gt;\n  update_role(Date, new_role = \"ID\") |&gt;                             # exclude from modeling\n\n  # 2) Dummy-code categorical predictors (Seasons, Holiday, day_type)\n  step_dummy(all_nominal_predictors(), one_hot = TRUE) |&gt;\n\n  # 3) Add interactions:\n  #    - Seasons × Holiday  (all season dummies with all holiday dummies)\n  #    - Seasons × MeanTemp (each season dummy with temperature)\n  #    - MeanTemp × TotalRainfall\n  step_interact(terms = ~ starts_with(\"Seasons_\"):starts_with(\"Holiday_\")\n                        + starts_with(\"Seasons_\"):MeanTemp\n                        + MeanTemp:TotalRainfall) |&gt;\n\n  # 4) Standardize all numeric predictors (after creating interaction columns)\n  step_normalize(all_numeric_predictors())\n\n\nlibrary(tidymodels)\nlibrary(dplyr)\n\n# Identify the ORIGINAL numeric predictors \nnum_base &lt;- bike_train |&gt;\n  select(where(is.numeric), -TotalBikes) |&gt;\n  names()\n\n# Recipe 3\nrec_mlr_3 &lt;- recipe(TotalBikes ~ ., data = bike_train) |&gt;\n  # 1) Derive weekday/weekend from Date; keep Date only as an ID\n  step_date(Date, features = \"dow\", label = TRUE) |&gt;\n  step_mutate(day_type = factor(if_else(Date_dow %in% c(\"Sat\",\"Sun\"),\n                                        \"Weekend\", \"Weekday\"))) |&gt;\n  step_rm(Date_dow) %&gt;%\n  update_role(Date, new_role = \"ID\") |&gt;\n\n  # 2) Dummy-code categorical predictors first (so we can form interactions with dummies)\n  step_dummy(all_nominal_predictors(), one_hot = TRUE) |&gt;\n\n  # 3) Interactions (same as Recipe 2)\n  step_interact(terms = ~ starts_with(\"Seasons_\"):starts_with(\"Holiday_\")\n                        + starts_with(\"Seasons_\"):MeanTemp\n                        + MeanTemp:TotalRainfall) |&gt;\n\n  # 4) Quadratic terms \n  step_poly(all_of(num_base), degree = 2, options = list(raw = TRUE)) |&gt;\n\n  # 5) Standardize all numeric predictors (includes the squared terms)\n  step_normalize(all_numeric_predictors())\n\n\nlibrary(tidymodels)\nlibrary(dplyr)\n\n# Model spec\nlm_spec &lt;- linear_reg() |&gt;\n  set_engine(\"lm\")\n\n#Workflows for the three recipes \nwf1 &lt;- workflow() %&gt;% add_model(lm_spec) %&gt;% add_recipe(rec_mlr_1)\nwf2 &lt;- workflow() %&gt;% add_model(lm_spec) %&gt;% add_recipe(rec_mlr_2)\nwf3 &lt;- workflow() %&gt;% add_model(lm_spec) %&gt;% add_recipe(rec_mlr_3)\n\nwfs &lt;- list(\n  rec1 = wf1,\n  rec2 = wf2,\n  rec3 = wf3\n)\n\n# 10-fold CV on training set for each recipe \nset.seed(123)\nctrl &lt;- control_resamples(save_pred = TRUE)\n\ncv_results &lt;- purrr::imap_dfr(\n  wfs,\n  ~ fit_resamples(.x, resamples = bike_folds, control = ctrl) |&gt;\n    collect_metrics() |&gt;\n    mutate(model = .y)\n)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x10\n\n\n\n\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x4\n\n\n→ B | warning: !  The following column has zero variance so scaling cannot be used:\n                 Seasons_Spring_x_Holiday_Holiday.\n               ℹ Consider using ?step_zv (`?recipes::step_zv()`) to remove those columns\n                 before normalizing.\n\n\nThere were issues with some computations   A: x4\nThere were issues with some computations   A: x10   B: x2\n\n\nWarning: Using `all_of()` outside of a selecting function was deprecated in tidyselect\n1.2.0.\nℹ See details at\n  &lt;https://tidyselect.r-lib.org/reference/faq-selection-context.html&gt;\n\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n→ B | warning: !  The following column has zero variance so scaling cannot be used:\n                 Seasons_Spring_x_Holiday_Holiday.\n               ℹ Consider using ?step_zv (`?recipes::step_zv()`) to remove those columns\n                 before normalizing.\nThere were issues with some computations   A: x9   B: x2\nThere were issues with some computations   A: x10   B: x2\n\n# View CV metrics (RMSE lower is better; also R^2 shown)\ncv_results |&gt; arrange(.metric, mean)\n\n# A tibble: 6 × 7\n  .metric .estimator     mean     n  std_err .config         model\n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;\n1 rmse    standard   5017.       10 348.     pre0_mod0_post0 rec2 \n2 rmse    standard   5054.       10 365.     pre0_mod0_post0 rec3 \n3 rmse    standard   5581.       10 227.     pre0_mod0_post0 rec1 \n4 rsq     standard      0.703    10   0.0241 pre0_mod0_post0 rec1 \n5 rsq     standard      0.747    10   0.0385 pre0_mod0_post0 rec3 \n6 rsq     standard      0.750    10   0.0379 pre0_mod0_post0 rec2 \n\n\n\n# Select best by RMSE \nbest_name &lt;- cv_results |&gt;\n  filter(.metric == \"rmse\") |&gt;\n  arrange(mean) |&gt;\n  slice(1) |&gt;\n  pull(model)\n\nbest_wf &lt;- wfs[[best_name]]\nbest_name\n\n[1] \"rec2\"\n\n\n\n# Fit best model on entire training and evaluate on test\nset.seed(123)\nfinal_res &lt;- last_fit(best_wf, split = bike_split)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n# Test-set metrics (includes RMSE)\nfinal_metrics &lt;- collect_metrics(final_res)\nfinal_metrics\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;          \n1 rmse    standard    5667.    pre0_mod0_post0\n2 rsq     standard       0.701 pre0_mod0_post0\n\n\n\n# Coefficient table from the final model\nfinal_coefs &lt;- final_res |&gt;\n  extract_workflow() |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()\n\nfinal_coefs\n\n# A tibble: 30 × 5\n   term               estimate std.error statistic   p.value\n   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 (Intercept)         16977.       301.    56.5   4.89e-145\n 2 TotalRainfall        -976.      1338.    -0.730 4.66e-  1\n 3 TotalSnowfall         -52.6      328.    -0.161 8.73e-  1\n 4 MeanTemp            -2958.      5764.    -0.513 6.08e-  1\n 5 MeanHumidity        -3336.      2232.    -1.49  1.36e-  1\n 6 MeanWindSpeed        -776.       346.    -2.24  2.60e-  2\n 7 MeanVisibility        288.       452.     0.637 5.25e-  1\n 8 MeanDewPoint         8726.      6845.     1.27  2.04e-  1\n 9 MeanSolarRadiation   3095.       567.     5.46  1.13e-  7\n10 Seasons_Autumn       2636.       723.     3.64  3.25e-  4\n# ℹ 20 more rows"
  }
]